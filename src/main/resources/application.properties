quarkus.application.name=parser

# Production port allocation
quarkus.http.port=39001

%dev.quarkus.logging-manager.openapi.included=true

# gRPC Client pointing to registration service via Stork/Consul
quarkus.grpc.clients.registration-service.host=registration-service
quarkus.grpc.clients.registration-service.name-resolver=stork

# Stork service discovery configuration
quarkus.stork.registration-service.service-discovery.type=consul
quarkus.stork.registration-service.service-discovery.consul-host=${CONSUL_HOST:consul}
quarkus.stork.registration-service.service-discovery.consul-port=${CONSUL_PORT:8500}

# Development override - use localhost Consul in dev mode  
%dev.quarkus.stork.registration-service.service-discovery.consul-host=localhost

# Pipestream Service Registration Configuration
pipestream.server.class=module
pipestream.registration.service-name=parser
pipestream.registration.type=MODULE
pipestream.registration.description=Document parsing module using Apache Tika for extracting text and metadata
pipestream.registration.capabilities=document-parsing,text-extraction,metadata-extraction,tika
pipestream.registration.tags=parser,tika,document-processing,module

# Disable for tests
%test.pipestream.registration.enabled=false

# Module configuration
module.name=parser
module.type=processor
module.description=Document parsing module using Apache Tika

# Health check configuration - use localhost for local development
module.health.check.host=localhost

# Logging Configuration - reduce noise
quarkus.log.level=INFO
quarkus.log.category."ai.pipestream".level=DEBUG
quarkus.log.category."io.vertx.ext.consul".level=WARN
quarkus.log.category."io.quarkus.grpc".level=WARN

# Index Docling API for Enums
quarkus.index-dependency."docling-api".group-id=ai.docling
quarkus.index-dependency."docling-api".artifact-id=docling-serve-api

# HTTP Request Body Size Configuration (40MB for parser endpoints)
quarkus.http.limits.max-body-size=40M
quarkus.http.limits.max-form-attribute-size=40M

# Context path: entire app (REST, static UI, OpenAPI, health) under /modules/parser
# Use relative URLs in the mini-frontend so it works under this path.
quarkus.http.root-path=/modules/parser

# REST is relative to root-path: full path = /modules/parser/api/parser/service/*
# (Do not set quarkus.rest.path so JAX-RS uses root-path as base.)

# Quinoa configuration for Hello World UI
quarkus.quinoa.ui-root-path=/admin
quarkus.quinoa.enable-spa-routing=true
quarkus.quinoa.package-manager-install=true
quarkus.quinoa.package-manager-install.bun-version=1.3.8

# Test settings  
%test.quarkus.http.port=0
# Processing buffer configuration
processing.buffer.enabled=false
processing.buffer.capacity=200
processing.buffer.directory=build/test-data
processing.buffer.prefix=parser



# Compose Dev Services - Auto-configured by pipestream-server
# Kafka Dev Services - enabled, will use Kafka from compose
%dev.quarkus.kafka.devservices.enabled=true
%dev.kafka.bootstrap.servers=localhost:9094

# Docling Configuration
# Dev mode - devservices will start Docling container automatically (enabled by default)
# The api-key is set by devservices automatically to "default-api-key"
# No explicit config needed for dev mode - devservices handles everything

# Production - use external Docling service
%prod.quarkus.docling.devservices.enabled=false
%prod.quarkus.docling.base-url=${DOCLING_BASE_URL:http://docling-serve:5001}
%prod.quarkus.docling.api-key=${DOCLING_API_KEY:default-api-key}

# Docling Client Timeout
quarkus.rest-client."io.quarkiverse.docling.runtime.client.QuarkusDoclingServeClient".connect-timeout=300000
quarkus.rest-client."io.quarkiverse.docling.runtime.client.QuarkusDoclingServeClient".read-timeout=300000
